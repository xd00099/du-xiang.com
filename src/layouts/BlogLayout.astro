---
interface Props {
  title: string;
  description: string;
  date: string;
  readTime: string;
  tags?: string[];
}

const { title, description, date, readTime, tags = [] } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta name="author" content="Du Xiang" />

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://du-xiang.com" />

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="/images/title.jpg" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />

    <title>{title} | Du Xiang</title>
  </head>
  <body>
    <header class="blog-header">
      <a href="/" class="back-link">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="19" y1="12" x2="5" y2="12"/>
          <polyline points="12 19 5 12 12 5"/>
        </svg>
        Back to Home
      </a>
    </header>

    <main class="blog-main">
      <article class="blog-article">
        <header class="article-header">
          <div class="article-meta">
            <time datetime={date}>{new Date(date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
            <span class="separator">Â·</span>
            <span>{readTime}</span>
          </div>
          <h1>{title}</h1>
          <p class="article-description">{description}</p>
          {tags.length > 0 && (
            <div class="article-tags">
              {tags.map(tag => (
                <span class="tag">{tag}</span>
              ))}
            </div>
          )}
        </header>

        <div class="article-content">
          <slot />
        </div>
      </article>
    </main>

    <footer class="blog-footer">
      <p>Written by <a href="/">Du Xiang</a></p>
    </footer>
  </body>
</html>

<style is:global>
  @import '../styles/global.css';

  body {
    background: var(--color-bg);
  }

  .blog-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 60px;
    display: flex;
    align-items: center;
    padding: 0 var(--space-6);
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--color-border);
    z-index: 100;
  }

  .back-link {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    color: var(--color-text-secondary);
    font-size: var(--text-sm);
    font-weight: 500;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .back-link:hover {
    color: var(--color-text);
  }

  .blog-main {
    min-height: 100vh;
    padding-top: 100px;
    padding-bottom: var(--space-20);
  }

  .blog-article {
    max-width: 720px;
    margin: 0 auto;
    padding: 0 var(--space-6);
  }

  .article-header {
    margin-bottom: var(--space-12);
    padding-bottom: var(--space-8);
    border-bottom: 1px solid var(--color-border);
  }

  .article-meta {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin-bottom: var(--space-4);
  }

  .separator {
    opacity: 0.3;
  }

  .article-header h1 {
    font-size: clamp(var(--text-3xl), 5vw, var(--text-4xl));
    line-height: 1.2;
    margin-bottom: var(--space-4);
  }

  .article-description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    line-height: 1.6;
  }

  .article-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    margin-top: var(--space-6);
  }

  .article-tags .tag {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    padding: var(--space-1) var(--space-3);
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border);
    border-radius: 9999px;
  }

  /* Article Content Styles */
  .article-content {
    font-size: var(--text-lg);
    line-height: 1.8;
    color: var(--color-text-secondary);
  }

  .article-content h2 {
    font-size: var(--text-2xl);
    margin-top: var(--space-12);
    margin-bottom: var(--space-6);
    padding-top: var(--space-4);
    border-top: 1px solid var(--color-border);
  }

  .article-content h3 {
    font-size: var(--text-xl);
    margin-top: var(--space-8);
    margin-bottom: var(--space-4);
  }

  .article-content h4 {
    font-size: var(--text-lg);
    margin-top: var(--space-6);
    margin-bottom: var(--space-3);
  }

  .article-content p {
    margin-bottom: var(--space-6);
  }

  .article-content strong {
    color: var(--color-text);
    font-weight: 600;
  }

  .article-content em {
    font-style: italic;
  }

  .article-content a {
    color: #a78bfa;
    text-decoration: underline;
    text-underline-offset: 3px;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .article-content a:hover {
    color: #c4b5fd;
  }

  .article-content ul,
  .article-content ol {
    margin-bottom: var(--space-6);
    padding-left: var(--space-6);
  }

  .article-content li {
    margin-bottom: var(--space-2);
  }

  .article-content li::marker {
    color: var(--color-text-muted);
  }

  .article-content blockquote {
    margin: var(--space-8) 0;
    padding: var(--space-4) var(--space-6);
    border-left: 3px solid #a78bfa;
    background: var(--color-bg-elevated);
    border-radius: 0 8px 8px 0;
    font-style: italic;
  }

  .article-content blockquote p {
    margin-bottom: 0;
  }

  /* Code Blocks */
  .article-content code {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.9em;
  }

  .article-content :not(pre) > code {
    background: var(--color-bg-elevated);
    padding: 0.2em 0.4em;
    border-radius: 4px;
    color: #f472b6;
  }

  .article-content pre {
    margin: var(--space-6) 0;
    padding: var(--space-6);
    background: #0d1117;
    border: 1px solid var(--color-border);
    border-radius: 12px;
    overflow-x: auto;
    font-size: var(--text-sm);
    line-height: 1.6;
  }

  .article-content pre code {
    background: none;
    padding: 0;
    color: #e6edf3;
  }

  /* Images */
  .article-content img {
    max-width: 100%;
    height: auto;
    border-radius: 12px;
    margin: var(--space-8) 0;
    border: 1px solid var(--color-border);
  }

  /* Tables */
  .article-content table {
    width: 100%;
    margin: var(--space-8) 0;
    border-collapse: collapse;
    font-size: var(--text-sm);
  }

  .article-content th,
  .article-content td {
    padding: var(--space-3) var(--space-4);
    border: 1px solid var(--color-border);
    text-align: left;
  }

  .article-content th {
    background: var(--color-bg-elevated);
    font-weight: 600;
    color: var(--color-text);
  }

  /* Horizontal Rule */
  .article-content hr {
    margin: var(--space-12) 0;
    border: none;
    border-top: 1px solid var(--color-border);
  }

  /* Callout Boxes */
  .callout {
    margin: var(--space-8) 0;
    padding: var(--space-6);
    background: var(--color-bg-elevated);
    border: 1px solid var(--color-border);
    border-radius: 12px;
  }

  .callout-title {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-weight: 600;
    color: var(--color-text);
    margin-bottom: var(--space-3);
  }

  .callout.insight {
    border-left: 3px solid #a78bfa;
  }

  .callout.warning {
    border-left: 3px solid #f59e0b;
  }

  .callout.tip {
    border-left: 3px solid #10b981;
  }

  /* Blog Footer */
  .blog-footer {
    max-width: 720px;
    margin: 0 auto;
    padding: var(--space-8) var(--space-6);
    border-top: 1px solid var(--color-border);
    text-align: center;
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  .blog-footer a {
    color: var(--color-text-secondary);
  }

  .blog-footer a:hover {
    color: var(--color-text);
  }

  /* Math-like styling */
  .formula {
    display: block;
    margin: var(--space-6) 0;
    padding: var(--space-4);
    background: var(--color-bg-elevated);
    border-radius: 8px;
    text-align: center;
    font-family: 'JetBrains Mono', monospace;
    color: var(--color-text);
    overflow-x: auto;
  }

  /* Figure with caption */
  figure {
    margin: var(--space-8) 0;
  }

  figcaption {
    text-align: center;
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin-top: var(--space-3);
  }

  @media (max-width: 768px) {
    .blog-main {
      padding-top: 80px;
    }

    .article-content {
      font-size: var(--text-base);
    }

    .article-content pre {
      padding: var(--space-4);
      font-size: var(--text-xs);
      margin-left: calc(-1 * var(--space-6));
      margin-right: calc(-1 * var(--space-6));
      border-radius: 0;
    }
  }
</style>
